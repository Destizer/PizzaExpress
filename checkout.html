<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ff6b35">
    <link rel="manifest" href="manifest.json">
    <title>–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ - PizzaExpress</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header class="header">
        <div class="header__container">
            <a href="cart.html" class="header__back">‚Üê –ù–∞–∑–∞–¥</a>
            <div class="header__logo">
                <span class="header__logo-text">–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</span>
            </div>
        </div>
    </header>

    <main class="checkout">
        <div class="checkout__container">
            <form class="checkout__form" id="checkoutForm">
                <!-- –®–∞–≥ 1: –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
                <section class="checkout__section">
                    <h2 class="checkout__section-title">1. –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h2>

                    <div class="form-group">
                        <label class="form-group__label" for="name">–ò–º—è *</label>
                        <input type="text"
                               class="form-group__input"
                               id="name"
                               required
                               placeholder="–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤">
                    </div>

                    <div class="form-group">
                        <label class="form-group__label" for="phone">–¢–µ–ª–µ—Ñ–æ–Ω *</label>
                        <input type="tel"
                               class="form-group__input"
                               id="phone"
                               required
                               placeholder="+7 (___) ___-__-__">
                    </div>

                    <div class="form-group">
                        <label class="form-group__label" for="email">Email</label>
                        <input type="email"
                               class="form-group__input"
                               id="email"
                               placeholder="example@mail.ru">
                    </div>
                </section>

                <!-- –®–∞–≥ 2: –î–æ—Å—Ç–∞–≤–∫–∞ -->
                <section class="checkout__section">
                    <h2 class="checkout__section-title">2. –î–æ—Å—Ç–∞–≤–∫–∞</h2>

                    <div class="form-group">
                        <label class="form-group__label">–°–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è *</label>
                        <div class="radio-group">
                            <label class="radio-group__item">
                                <input type="radio"
                                       name="deliveryType"
                                       value="delivery"
                                       checked>
                                <span>üöó –î–æ—Å—Ç–∞–≤–∫–∞ (150 ‚ÇΩ)</span>
                            </label>
                            <label class="radio-group__item">
                                <input type="radio"
                                       name="deliveryType"
                                       value="pickup">
                                <span>üè™ –°–∞–º–æ–≤—ã–≤–æ–∑ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)</span>
                            </label>
                        </div>
                    </div>

                    <div id="addressFields">
                        <div class="form-group">
                            <label class="form-group__label" for="street">–£–ª–∏—Ü–∞ *</label>
                            <input type="text"
                                   class="form-group__input"
                                   id="street"
                                   placeholder="–õ–µ–Ω–∏–Ω–∞">
                        </div>

                        <div class="form-group form-group--inline">
                            <div class="form-group">
                                <label class="form-group__label" for="house">–î–æ–º *</label>
                                <input type="text"
                                       class="form-group__input"
                                       id="house"
                                       placeholder="12">
                            </div>
                            <div class="form-group">
                                <label class="form-group__label" for="apartment">–ö–≤–∞—Ä—Ç–∏—Ä–∞</label>
                                <input type="text"
                                       class="form-group__input"
                                       id="apartment"
                                       placeholder="45">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="form-group__label" for="comment">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∞–¥—Ä–µ—Å—É</label>
                            <textarea class="form-group__textarea"
                                      id="comment"
                                      rows="3"
                                      placeholder="–î–æ–º–æ—Ñ–æ–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–∑–≤–æ–Ω–∏—Ç–µ"></textarea>
                        </div>
                    </div>
                </section>

                <!-- –®–∞–≥ 3: –û–ø–ª–∞—Ç–∞ -->
                <section class="checkout__section">
                    <h2 class="checkout__section-title">3. –û–ø–ª–∞—Ç–∞</h2>

                    <div class="form-group">
                        <label class="form-group__label">–°–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã *</label>
                        <div class="radio-group">
                            <label class="radio-group__item">
                                <input type="radio"
                                       name="paymentType"
                                       value="cash"
                                       checked>
                                <span>üíµ –ù–∞–ª–∏—á–Ω—ã–º–∏ –∫—É—Ä—å–µ—Ä—É</span>
                            </label>
                            <label class="radio-group__item">
                                <input type="radio"
                                       name="paymentType"
                                       value="card">
                                <span>üí≥ –ö–∞—Ä—Ç–æ–π –∫—É—Ä—å–µ—Ä—É</span>
                            </label>
                            <label class="radio-group__item">
                                <input type="radio"
                                       name="paymentType"
                                       value="online">
                                <span>üåê –û–Ω–ª–∞–π–Ω –æ–ø–ª–∞—Ç–∞</span>
                            </label>
                        </div>
                    </div>
                </section>

                <!-- –ò—Ç–æ–≥–æ -->
                <section class="checkout__summary">
                    <h3 class="checkout__summary-title">–í–∞—à –∑–∞–∫–∞–∑</h3>
                    <div class="checkout__summary-items" id="orderItems"></div>
                    <div class="checkout__summary-total">
                        <span>–ò—Ç–æ–≥–æ:</span>
                        <span id="orderTotal">0 ‚ÇΩ</span>
                    </div>
                </section>

                <button type="submit" class="button button--primary button--full">
                    –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑
                </button>
            </form>
        </div>
    </main>

    <script src="js/app.js"></script>
    <script>
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–æ—Å—Ç–∞–≤–∫–æ–π –∏ —Å–∞–º–æ–≤—ã–≤–æ–∑–æ–º
        document.querySelectorAll('[name="deliveryType"]').forEach(radio => {
            radio.addEventListener('change', (e) => {
                const addressFields = document.getElementById('addressFields');
                if (e.target.value === 'delivery') {
                    addressFields.style.display = 'block';
                } else {
                    addressFields.style.display = 'none';
                }
            });
        });

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
        function loadOrderItems() {
            const orderItems = document.getElementById('orderItems');
            const orderTotal = document.getElementById('orderTotal');
            const cart = window.cart || new Cart();

            if (cart.items.length === 0) {
                window.location.href = 'cart.html';
                return;
            }

            orderItems.innerHTML = cart.items.map(item => `
                    <div class="checkout__item">
                        <span>${item.name} (${item.size}, ${item.dough}) x${item.quantity}</span>
                        <span>${item.price * item.quantity} ‚ÇΩ</span>
                    </div>
                `).join('');

            const deliveryType = document.querySelector('[name="deliveryType"]:checked').value;
            const deliveryCost = deliveryType === 'delivery' ? 150 : 0;
            const total = cart.getTotal() + deliveryCost;
            orderTotal.textContent = total + ' ‚ÇΩ';
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã
        document.getElementById('checkoutForm').addEventListener('submit', (e) => {
            e.preventDefault();

            const formData = {
                name: document.getElementById('name').value,
                phone: document.getElementById('phone').value,
                email: document.getElementById('email').value,
                deliveryType: document.querySelector('[name="deliveryType"]:checked').value,
                paymentType: document.querySelector('[name="paymentType"]:checked').value,
                street: document.getElementById('street').value,
                house: document.getElementById('house').value,
                apartment: document.getElementById('apartment').value,
                comment: document.getElementById('comment').value
            };

            // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            const cart = window.cart || new Cart();
            const order = {
                id: 'ORDER_' + Date.now(),
                date: new Date().toISOString(),
                items: cart.items,
                customer: formData,
                total: cart.getTotal() + (formData.deliveryType === 'delivery' ? 150 : 0),
                status: 'pending'
            };

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            orders.push(order);
            localStorage.setItem('orders', JSON.stringify(orders));

            // –û—á–∏—Å—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
            cart.clear();

            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            alert('–ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω! –ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: ' + order.id);
            window.location.href = 'orders.html';
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadOrderItems();
    </script>
</body>
</html>