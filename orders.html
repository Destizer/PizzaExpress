<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#ff6b35">
    <link rel="manifest" href="manifest.json">
    <title>–ú–æ–∏ –∑–∞–∫–∞–∑—ã - PizzaExpress</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <header class="header">
        <div class="header__container">
            <button class="header__burger" id="burger">
                <span class="header__burger-line"></span>
                <span class="header__burger-line"></span>
                <span class="header__burger-line"></span>
            </button>

            <div class="header__logo">
                <span class="header__logo-icon">üçï</span>
                <span class="header__logo-text">PizzaExpress</span>
            </div>

            <nav class="header__nav" id="nav">
                <a href="index.html" class="header__nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                <a href="menu.html" class="header__nav-link">–ú–µ–Ω—é</a>
                <a href="cart.html" class="header__nav-link">–ö–æ—Ä–∑–∏–Ω–∞ <span class="header__cart-count" id="cartCount">0</span></a>
                <a href="orders.html" class="header__nav-link header__nav-link--active">–ó–∞–∫–∞–∑—ã</a>
                <a href="contacts.html" class="header__nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a>
            </nav>

            <button class="header__profile" id="profileBtn">
                <span class="header__profile-icon">üë§</span>
            </button>
        </div>
    </header>

    <main class="orders">
        <div class="orders__container">
            <h1 class="orders__title">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</h1>

            <div class="orders__list" id="ordersList">
                <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è -->
            </div>

            <div class="orders__empty" id="emptyOrders" style="display: none;">
                <div class="orders__empty-icon">üì¶</div>
                <h3 class="orders__empty-title">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</h3>
                <p class="orders__empty-text">–û—Ñ–æ—Ä–º–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å!</p>
                <a href="menu.html" class="button button--primary">–ü–µ—Ä–µ–π—Ç–∏ –≤ –º–µ–Ω—é</a>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="footer__container">
            <div class="footer__section">
                <h3 class="footer__title">PizzaExpress</h3>
                <p class="footer__text">–í–∫—É—Å–Ω–∞—è –ø–∏—Ü—Ü–∞ —Å 2020 –≥–æ–¥–∞</p>
            </div>
        </div>
        <div class="footer__bottom">
            <p>&copy; 2025 PizzaExpress</p>
        </div>
    </footer>

    <nav class="bottom-nav">
        <a href="index.html" class="bottom-nav__item">
            <span class="bottom-nav__icon">üè†</span>
            <span class="bottom-nav__label">–ì–ª–∞–≤–Ω–∞—è</span>
        </a>
        <a href="menu.html" class="bottom-nav__item">
            <span class="bottom-nav__icon">üìã</span>
            <span class="bottom-nav__label">–ú–µ–Ω—é</span>
        </a>
        <a href="cart.html" class="bottom-nav__item">
            <span class="bottom-nav__icon">üõí</span>
            <span class="bottom-nav__label">–ö–æ—Ä–∑–∏–Ω–∞</span>
        </a>
        <a href="orders.html" class="bottom-nav__item bottom-nav__item--active">
            <span class="bottom-nav__icon">üì¶</span>
            <span class="bottom-nav__label">–ó–∞–∫–∞–∑—ã</span>
        </a>
        <a href="profile.html" class="bottom-nav__item">
            <span class="bottom-nav__icon">üë§</span>
            <span class="bottom-nav__label">–ü—Ä–æ—Ñ–∏–ª—å</span>
        </a>
    </nav>

    <script src="js/app.js"></script>
    <script>
        function loadOrders() {
            const ordersList = document.getElementById('ordersList');
            const emptyOrders = document.getElementById('emptyOrders');
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');

            if (orders.length === 0) {
                ordersList.style.display = 'none';
                emptyOrders.style.display = 'block';
                return;
            }

            ordersList.style.display = 'block';
            emptyOrders.style.display = 'none';

            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
            orders.sort((a, b) => new Date(b.date) - new Date(a.date));

            ordersList.innerHTML = orders.map(order => {
                const date = new Date(order.date);
                const dateStr = date.toLocaleDateString('ru-RU', {
                    day: 'numeric',
                    month: 'long',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });

                const statusLabels = {
                    'pending': { text: '–í –æ–±—Ä–∞–±–æ—Ç–∫–µ', class: 'warning' },
                    'confirmed': { text: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω', class: 'info' },
                    'cooking': { text: '–ì–æ—Ç–æ–≤–∏—Ç—Å—è', class: 'info' },
                    'delivery': { text: '–í –¥–æ—Å—Ç–∞–≤–∫–µ', class: 'info' },
                    'completed': { text: '–î–æ—Å—Ç–∞–≤–ª–µ–Ω', class: 'success' },
                    'cancelled': { text: '–û—Ç–º–µ–Ω–µ–Ω', class: 'danger' }
                };

                const status = statusLabels[order.status] || statusLabels.pending;

                return `
                        <div class="order-card">
                            <div class="order-card__header">
                                <div class="order-card__info">
                                    <h3 class="order-card__number">–ó–∞–∫–∞–∑ ${order.id}</h3>
                                    <p class="order-card__date">${dateStr}</p>
                                </div>
                                <span class="order-card__status order-card__status--${status.class}">
                                    ${status.text}
                                </span>
                            </div>

                            <div class="order-card__items">
                                ${order.items.map(item => `
                                    <div class="order-card__item">
                                        <span class="order-card__item-icon">${item.image || 'üçï'}</span>
                                        <span class="order-card__item-name">${item.name} (${item.size})</span>
                                        <span class="order-card__item-quantity">x${item.quantity}</span>
                                    </div>
                                `).join('')}
                            </div>

                            <div class="order-card__footer">
                                <span class="order-card__total">–ò—Ç–æ–≥–æ: ${order.total} ‚ÇΩ</span>
                                <button class="order-card__button button button--secondary"
                                        onclick="repeatOrder('${order.id}')">
                                    –ü–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–∫–∞–∑
                                </button>
                            </div>
                        </div>
                    `;
            }).join('');
        }

        function repeatOrder(orderId) {
            const orders = JSON.parse(localStorage.getItem('orders') || '[]');
            const order = orders.find(o => o.id === orderId);

            if (!order) return;

            const cart = window.cart || new Cart();

            order.items.forEach(item => {
                cart.addItem(item, item.size, item.dough);
            });

            window.location.href = 'cart.html';
        }

        window.repeatOrder = repeatOrder;
        loadOrders();
    </script>
</body>
</html>